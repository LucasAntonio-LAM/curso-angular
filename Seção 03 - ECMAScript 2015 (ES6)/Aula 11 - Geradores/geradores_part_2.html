<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste live server</title>
</head>
<body>
    <div id="teste">
        <button type="button" onclick="acao()">Avançar</button>
        Resposta: <input type="text" name="" id="resposta">
    </div>

    <script>
        
       function* conversar() {
            // Escopo Próprio
            // opcao
            
            // Primeiro Bloco
            let opcao = yield 'Eae, tudo bem?'
            // O parâmetro enviado no next

            // Segundo Bloco
            if(opcao == 'Sim') {
                yield 'Ótimo fico feliz!'

                opcao = yield 'Como eu posso te ajudar? Quer uma piada para começar?'

                if(opcao == 'Sim') {
                    fetch('dados/piadas.json')
                        .then(resposta => resposta.json())
                        .then(piadas => {
                            let idx = Math.floor((Math.random() * 10))
                            let piada = piadas[idx]

                            console.log(piada.piada)
                            setTimeout(() => {
                                console.log(piada.resposta)
                                console.log('HAHAHAHAHAHAHAH')
                                console.log('MUITO BOA NÉ')

                                
                            }, 4000)  
                        }) 

                        yield 'Digite 1 para compras, 2 para vendas ou 3 para falar com um atendente'

                } else {
                    yield 'Digite 1 para compras, 2 para vendas ou 3 para falar com um atendente'
                }
            } else {
                yield 'Respire fundo e tenha paciência'

                yield 'Digite 1 para compras, 2 para vendas ou 3 para falar com um atendente'
            }
            
            return 'Atendimento Finalizado'
            
       }

       let conversa = conversar() // Obj iterator

       


       function acao() {
            let resposta = document.getElementById('resposta').value

            
            let iteracao = conversa.next(resposta) //
            console.log(iteracao) 

            if(iteracao.done) {
                document.getElementById('teste').style.display = 'none'
            }
       }
    </script>
</body>
</html>